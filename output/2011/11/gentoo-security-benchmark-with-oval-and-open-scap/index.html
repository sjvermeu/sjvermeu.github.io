<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Gentoo Security Benchmark with OVAL and Open-SCAP - Simplicity is a form of art...</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://blog.siphos.be/2011/11/gentoo-security-benchmark-with-oval-and-open-scap/">

        <meta name="author" content="Sven Vermeulen" />
        <meta name="description" content="A while ago, I got referred to the Open Vulnerability and Assessment Language, which seems to be an open specification (or even standard) for defining security content/information and being able to document such things in a way that tools can interpret it. Actually, it is a set of these …" />

        <meta property="og:site_name" content="Simplicity is a form of art..." />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Gentoo Security Benchmark with OVAL and Open-SCAP"/>
        <meta property="og:url" content="http://blog.siphos.be/2011/11/gentoo-security-benchmark-with-oval-and-open-scap/"/>
        <meta property="og:description" content="A while ago, I got referred to the Open Vulnerability and Assessment Language, which seems to be an open specification (or even standard) for defining security content/information and being able to document such things in a way that tools can interpret it. Actually, it is a set of these …"/>
        <meta property="article:published_time" content="2011-11-16" />
            <meta property="article:section" content="Gentoo" />
            <meta property="article:author" content="Sven Vermeulen" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.siphos.be/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://blog.siphos.be/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.siphos.be/theme/css/pygments/native.css" rel="stylesheet">
    <link href="http://blog.siphos.be/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.siphos.be/theme/css/style.css" type="text/css"/>

        <link href="http://blog.siphos.be/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Simplicity is a form of art... ATOM Feed"/>



        <link href="http://blog.siphos.be/feeds/gentoo.atom.xml" type="application/atom+xml" rel="alternate"
              title="Simplicity is a form of art... Gentoo ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.siphos.be/" class="navbar-brand">
Simplicity is a form of art...            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="http://blog.siphos.be/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.siphos.be/2011/11/gentoo-security-benchmark-with-oval-and-open-scap/"
                       rel="bookmark"
                       title="Permalink to Gentoo Security Benchmark with OVAL and Open-SCAP">
                        Gentoo Security Benchmark with OVAL and Open-SCAP
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2011-11-16T23:09:00+01:00"> Wed 16 November 2011</time>
    </span>


            <span class="label label-default">By</span>
            <a href="http://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="http://blog.siphos.be/category/gentoo.html">Gentoo</a>


    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>A while ago, I got referred to the <a href="http://oval.mitre.org/">Open Vulnerability and Assessment
Language</a>, which seems to be an open
specification (or even standard) for defining security
content/information and being able to document such things in a way that
tools can interpret it. Actually, it is a set of these specifications.
But first:</p>
<blockquote>
<p>tl;dr <a href="http://dev.gentoo.org/~swift/docs/previews/oval/gentoo-xccdf-guide.html">Gentoo Security Benchmark
Guide</a>
with <a href="http://dev.gentoo.org/~swift/docs/previews/oval/gentoo-xccdf-report.html">example report on automated
tests</a>
based on
<a href="http://dev.gentoo.org/~swift/docs/previews/oval/scap-gentoo-xccdf.txt">XCCDF</a>
and
<a href="http://dev.gentoo.org/~swift/docs/previews/oval/scap-gentoo-oval2.txt">OVAL</a>,
interpreted by <a href="http://www.open-scap.org/page/Main_Page">Open-SCAP</a>.</p>
</blockquote>
<p>There; now that we have that out of our way, let's continue on the
somewhat more gory details. In this first post, I'd like to talk a bit
about XCCDF and OVAL, which are both imo overly complex but interesting
XML formats.</p>
<p>The first one, XCCDF, is better known as the <strong>Extensible Configuration
Checklist Description Format</strong> and is an XML format in which you
document settings (what should a system look like). By itself, that
doesn't warrant another XML format. However, the power of XCCDF is that
you can define in the document <em>profiles</em>. Each of these profiles is
then documented with the set of rules that applies to the profile. So
you can have an XCCDF document on the configuration of BIND (the
nameserver) and have two profiles: one for a single-server setup, and
one for a multi-server (master/slave) setup.</p>
<p>These rules also define checks that you can have a tool performed
against your configuration. These checks are documented in an OVAL XML
file (<strong>Open Vulnerability and Assessment Language</strong>) which can be
interpreted by an OVAL-compliant tool. A very simply put statement could
be: "File /etc/ssh/sshd_config must have a line that matches
'PermitRootLogin no'".</p>
<p>Of course, XML doesn't use simple statements. In the case of OVAL, a
specific form of normalization occurs.</p>
<ul>
<li>At the beginning, you define a <em>definition</em> that explains what you
    want to achieve (similar to the above statement) in plain text, and
    then refer to one or more criteria that needs to be passed if this
    line applies. Most checks in a configuration guide are simple
    criteria, but with OVAL you can create criteria like "If my system
    is a Gentoo x86_64 one, and I use the hardened profile, then
    criteria A must apply, but if my system does not use a hardened
    profile, it is criteria B".</li>
<li>The criteria refers to a <em>test</em> that needs to be executed. This test
    can be a file expression match, partition information check, service
    state, installed software, etc. but does not allow executing
    commands that the user defines (it is not considered a safe practice
    that you execute commands that are stated in the XML file since most
    OVAL interpreters will run as root). This test is based on two
    additional aspects:
    </p><ul>
<li>The <em>object</em> refers to the object or resource that is checked.
    This can be a partition or a file, or a list of lines that match
    an expression in a file, etc.</li>
<li>The <em>state</em> refers to the state that that object or resource
    should be in (or should match).</li>
</ul>
</li>
</ul>
<p>With this OVAL language in place, you can now refer to several tests to
enhance your XCCDF document, and allow OVAL interpreters to test the
various rules on your system. For me, this was the major reason to look
into the language, since I had my hopes up to update or rewrite the
<a href="http://www.gentoo.org/doc/en/security/security-handbook.xml">Gentoo Linux Security
Handbook</a>
but with a way for users to validate if their system adheres to most/all
statements made in that document.</p>
<p>As a matter of exercise, I started making such a security benchmark of
which you can find a <a href="http://dev.gentoo.org/~swift/docs/previews/oval/gentoo-xccdf-guide.html">HTML version
online</a>
(it's a preview URL, so might change in the future). And since it is
written with XCCDF and OVAL, I've also added an <a href="http://dev.gentoo.org/~swift/docs/previews/oval/gentoo-xccdf-report.html">example report on
automated
tests</a>
too. The sources of these documents are available as well
(<a href="http://dev.gentoo.org/~swift/docs/previews/oval/scap-gentoo-xccdf.txt">XCCDF</a>
and
<a href="http://dev.gentoo.org/~swift/docs/previews/oval/scap-gentoo-oval2.txt">OVAL</a>
- download as txt but rename to XML then).</p>
<p>For those adventurous enough to play with them: install
<code>app-forensics/openscap</code> so that you can parse the files. To generate
the guide itself, use
<code>oscap xccdf generate scap-gentoo-xccdf.xml &gt; guide.html</code>. To run the
tests associated with it, use
<code>oscap xccdf eval --oval-results --profile Gentoo-Default --report report.html scap-gentoo-xccdf.xml</code>.
Also take a look at the
<a href="http://www.open-scap.org/page/Main_Page">Open-SCAP</a> website which is a
good resource as well (and the mailinglists are low traffic but with
good response times!).</p>
<p>So, what is the future on all this for me?</p>
<p>First, I'm going to work a bit further on the OVAL statements, so that I
can automatically test the majority of settings that I currently have in
the benchmark/guide. Only when I'm far enough will I continue on the
content of the guide (since it is far from finished) and also see if
this isn't something that can be put on a somewhat more official
location. If not, I'll still continue developing it, but it'll remain on
my dev-page.</p>
<p>When I'm somewhat satisfied with that, I might check if I can't have
OVAL enhanced with some Gentoo-specific objects (there are already
objects for RedHat-like and Debian-like distributions) so that we can
write tests for Gentoo settings (like USE flags, profiles, enabled GCC
specs, etc.) If we have that, then we can even write checks (XCCDF and
OVAL based) to validate if a system is how it is supposed to be
(wouldn't that be great, an automated test that tells you if your system
is properly set up according to our documents).</p>
<p>But XCCDF and OVAL isn't the end. There are other formats available as
well, like CCE (for configuration entries), CVE/CPE (to check
vulnerability information and its target software/platform) and more. I
know RedHat is already actively using OVAL for its <a href="https://www.redhat.com/security/data/oval/">security
advisories</a>, and other sites
like <a href="http://cisecurity.org/">Center for Internet Security</a> are also
using XCCDF and OVAL to document and work with security guides. So why
would Gentoo not get on that train as well?</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <p>
        To comment as a guest, use "Or sign up with disqus" and then select the "I'd rather post as guest" option.
        </p>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'simplicityisaformofart'; // required: replace example with your forum shortname

                    var disqus_identifier = 'gentoo-security-benchmark-with-oval-and-open-scap';
                var disqus_url = 'http://blog.siphos.be/2011/11/gentoo-security-benchmark-with-oval-and-open-scap/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/sjvermeu"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
                <li class="list-group-item"><a href="https://twitter.com/sjvermeu"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
              </ul>
            </li>





    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Sven Vermeulen
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.siphos.be/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.siphos.be/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.siphos.be/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'simplicityisaformofart'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>