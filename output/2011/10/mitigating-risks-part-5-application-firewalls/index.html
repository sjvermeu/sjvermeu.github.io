<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Mitigating risks, part 5 - application firewalls - Simplicity is a form of art...</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="http://blog.siphos.be/2011/10/mitigating-risks-part-5-application-firewalls/">

        <meta name="author" content="Sven Vermeulen" />
        <meta name="description" content="The last isolation-related aspect on risk mitigation is called application firewalls. Like more &#34;regular&#34; firewalls, its purpose is to be put in front of a service, controlling which data/connections get through and which don&#39;t. But unlike these regular firewalls, application firewalls work on higher-level protocols (like HTTP, FTP) that …" />

        <meta property="og:site_name" content="Simplicity is a form of art..." />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Mitigating risks, part 5 - application firewalls"/>
        <meta property="og:url" content="http://blog.siphos.be/2011/10/mitigating-risks-part-5-application-firewalls/"/>
        <meta property="og:description" content="The last isolation-related aspect on risk mitigation is called application firewalls. Like more &#34;regular&#34; firewalls, its purpose is to be put in front of a service, controlling which data/connections get through and which don&#39;t. But unlike these regular firewalls, application firewalls work on higher-level protocols (like HTTP, FTP) that …"/>
        <meta property="article:published_time" content="2011-10-05" />
            <meta property="article:section" content="Security" />
            <meta property="article:author" content="Sven Vermeulen" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="http://blog.siphos.be/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="http://blog.siphos.be/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="http://blog.siphos.be/theme/css/pygments/native.css" rel="stylesheet">
    <link href="http://blog.siphos.be/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="http://blog.siphos.be/theme/css/style.css" type="text/css"/>

        <link href="http://blog.siphos.be/feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Simplicity is a form of art... ATOM Feed"/>



        <link href="http://blog.siphos.be/feeds/security.atom.xml" type="application/atom+xml" rel="alternate"
              title="Simplicity is a form of art... Security ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="http://blog.siphos.be/" class="navbar-brand">
Simplicity is a form of art...            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="http://blog.siphos.be/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="http://blog.siphos.be/2011/10/mitigating-risks-part-5-application-firewalls/"
                       rel="bookmark"
                       title="Permalink to Mitigating risks, part 5 - application firewalls">
                        Mitigating risks, part 5 - application firewalls
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2011-10-05T23:38:00+02:00"> Wed 05 October 2011</time>
    </span>


            <span class="label label-default">By</span>
            <a href="http://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="http://blog.siphos.be/category/security.html">Security</a>


    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>The last <em>isolation-related</em> aspect on risk mitigation is called
<strong>application firewalls</strong>. Like more "regular" firewalls, its purpose is
to be put in front of a service, controlling which data/connections get
through and which don't. But unlike these regular firewalls,
<a href="https://en.wikipedia.org/wiki/Application_firewall">application
firewalls</a> work on
higher-level protocols (like HTTP, FTP) that deal with user data rather
than with connection routing. I'm going to call these firewalls "network
firewalls", although most modern network firewalls have some application
firewall functionality as well.</p>
<p>The purpose and necessity of network firewalls is well known and
understood: make sure that the service is only accessible from the right
location, check if connections aren't abused (or too many connections
are made), etc. But what if the connection itself is valid? After all,
most abuse of services is not because they originate from the wrong
location or try to access the wrong service. Instead, such abuse comes
from valid access to the application, but with less kosher intentions.
So what can application firewalls do in this case?</p>
<ul>
<li>Because they perform inspection of the data that is transferred
    itself, application firewalls can <strong>detect malicious data
    fragments</strong> or attempts to abuse the service. These detection rules
    can be based on general, heuristic rules (well-known examples are
    detection rules for cross-site scripting attacks (XSS) or
    SQL Injection) but can also be very specific to a
    particular application.</li>
<li>Because all data is transferred through the firewall and the
    firewall has knowledge of the application itself, these firewalls
    offer <strong>advanced auditing features</strong> since they can detect
    authentication steps, user data, application-specific transactions
    and more.</li>
<li>With knowledge of the users' session and
    behavior (application-level) and origin (network level), application
    firewalls can <strong>detect and prevent unauthorized sessions</strong>, such as
    the case with session hijacking or even man-in-the-middle attacks
    (based on behavior detection)</li>
</ul>
<p>Implementing an application firewall however doesn't only mean that you
improve access controls on it. It has other advantages that make
application firewalls an important part in many architectures:</p>
<ul>
<li>If all service access is forced through the application firewall
    (for instance through an IP filter on the service that only allows
    connections from the application firewalls) you can implement rules
    that <strong>deter known attacks/vulnerabilities</strong> without needing to fix
    the code itself (or if fixing is possible, lower the time pressure).
    For instance, for Apache-based services, such an application
    firewall could detect or even change the <code>Range:</code> header on
    malicious requests to lower the impact of this potentially nasty DoS
    vulnerability</li>
<li>Depending on the complexity, some <strong>functional application bug
    fixing</strong> might even be possible. For instance changing content types
    on requests/replies (HTTP), adding a domain on an FTP accounts'
    login statement, ...</li>
<li>Many application firewalls (or gateways) offer proxy functionality
    which might <strong>improve response times</strong>. This is not a sure-given,
    since most applications are session-aware so the advantage is only
    for session-agnostic requests (be it static content or specific SQL
    statements in case of a database firewall). But also in case of
    session-aware statements can an improvement be found. Consider a
    database firewall which translates SQL statements from an
    unsupported application towards better defined statements (for
    instance using proper indexes or materialized views).</li>
<li>In some cases, you might even be able to upgrade a backend of an
    unsupported application (which previously required an outdated
    version of that database) by translating the backend requests when
    they are incompatible with the new backend version. So you can
    <strong>improve integration</strong> or <strong>support unsupported upgrades</strong>.</li>
<li>In case of risk reduction, application firewalls also allow you to
    move a service elsewhere (even in the <strong>public cloud</strong>) and still
    keep the access under control.</li>
</ul>
<p>Of course, it would be TGTBT (Too Good To Be True) if there isn't an
(important) downside: <em>maintaining the application firewall is a
daunting task</em>. Because of its flexibility, you'll need deep knowledge
in the application firewall administration and development, keep track
of all rules you have (and why you have them), do lots and lots of
testing on each rule (since it might affect the functioning of the
application) and still be aware that subtle differences introduced by
the application firewall rules can pop up unexpectedly. Also,
integrating an application firewall is another service between your
customer and his service, which might influence performance but also
makes the underlying architecture more complex. Finally, you'll need to
consider that an application firewall requires lots of resources
(CPU/memory), especially when it needs to perform SSL/TLS termination.
Oh, and they're often expensive too.</p>
<p>Still, even with these downsides, application firewalls are an important
part of the service isolation strategy, which is a key aspect in the
<a href="http://blog.siphos.be/2011/09/mitigating-risks-part-1/">risk mitigation
strategy</a> which
this series started with. We've focused on three now: <a href="http://blog.siphos.be/2011/09/mitigating-risks-part-2-service-isolation/">service
isolation</a>
(network-wise), process isolation (through <a href="http://blog.siphos.be/2011/09/mitigating-risks-part-4-mandatory-access-control/">mandatory access
control</a>)
and now access isolation through application firewalls. And with proper
<a href="http://blog.siphos.be/2011/09/mitigating-risks-part-3-hardening/">hardening</a>
in place, I believe that you have done all you can do to reduce the
risks when running unsupported software (apart from upgrading it or
switching towards supported software).</p>
<p>If you have other ideas that benefit risk mitigation, with specific
focus on unsupported software, I would be glad to hear about them.</p>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <p>
        To comment as a guest, use "Or sign up with disqus" and then select the "I'd rather post as guest" option.
        </p>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'simplicityisaformofart'; // required: replace example with your forum shortname

                    var disqus_identifier = 'mitigating-risks-part-5-application-firewalls';
                var disqus_url = 'http://blog.siphos.be/2011/10/mitigating-risks-part-5-application-firewalls/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/sjvermeu"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
                <li class="list-group-item"><a href="https://twitter.com/sjvermeu"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
              </ul>
            </li>





    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2018 Sven Vermeulen
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="http://blog.siphos.be/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="http://blog.siphos.be/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="http://blog.siphos.be/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'simplicityisaformofart'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>