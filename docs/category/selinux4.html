<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>SELinux - Simplicity is a form of art...</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">




    <meta name="author" content="Sven Vermeulen" />
    <meta name="keywords" content="SELinux" />

    <!-- Open Graph tags -->
        <meta property="og:site_name" content="Simplicity is a form of art..." />
        <meta property="og:type" content="website"/>
        <meta property="og:title" content="Simplicity is a form of art..."/>
        <meta property="og:url" content="https://blog.siphos.be"/>
        <meta property="og:description" content="Simplicity is a form of art..."/>


    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://blog.siphos.be/theme/css/bootstrap.min.css" type="text/css"/>
    <link href="https://blog.siphos.be/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://blog.siphos.be/theme/css/pygments/native.css" rel="stylesheet">
    <link href="https://blog.siphos.be/theme/tipuesearch/tipuesearch.css" rel="stylesheet">
    <link rel="stylesheet" href="https://blog.siphos.be/theme/css/style.css" type="text/css"/>

        <link href="https://blog.siphos.be/feed/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Simplicity is a form of art... ATOM Feed"/>

        <link href="https://blog.siphos.be/feed/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Simplicity is a form of art... RSS Feed"/>


        <link href="https://blog.siphos.be/category/selinux/feed/atom.xml" type="application/atom+xml" rel="alternate"
              title="Simplicity is a form of art... SELinux ATOM Feed"/>

</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a href="https://blog.siphos.be/" class="navbar-brand">
Simplicity is a form of art...            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><span>
                <form class="navbar-search" action="/search.html">
                  <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input" required>
                </form></span>
              </li>
              <li><a href="https://blog.siphos.be/archives.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
            <article>
                <h2><a href="https://blog.siphos.be/2013/08/network-routing-based-on-selinux/">Network routing based on SELinux?</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-08-21T19:43:00+02:00"> Wed 21 August 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/ipsec/">ipsec</a>
        /
	<a href="https://blog.siphos.be/tag/netlabel/">netlabel</a>
        /
	<a href="https://blog.siphos.be/tag/networking/">networking</a>
        /
	<a href="https://blog.siphos.be/tag/secmark/">secmark</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>Today we had a question on #selinux if it was possible to route traffic
of a specific process using SELinux. The answer to this is "no",
although it has to be explained a bit in more detail.</p>
<p>SELinux does not route traffic. SELinux is a local mandatory access
control system …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/08/network-routing-based-on-selinux/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/08/some-things-sound-more-scary-than-they-are/">Some things sound more scary than they are</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-08-15T10:02:00+02:00"> Thu 15 August 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/android/">android</a>
        /
	<a href="https://blog.siphos.be/tag/grsecurity/">grsecurity</a>
        /
	<a href="https://blog.siphos.be/tag/pax/">pax</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
        /
	<a href="https://blog.siphos.be/tag/tablet/">tablet</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>A few days ago I finally got to the next thing on my <em>Want to do this
year</em> list: put a new android
(<a href="http://www.cyanogenmod.org/">Cyanogenmod</a>) on my tablet, which was
still running the stock Android - but hasn't seen any updates in more
than a year. Considering the (in)security of Android …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/08/some-things-sound-more-scary-than-they-are/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/07/rebuilding-selinux-contexts-with-sefcontext_compile/">Rebuilding SELinux contexts with sefcontext_compile</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-07-08T20:55:00+02:00"> Mon 08 July 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/hardened/">hardened</a>
        /
	<a href="https://blog.siphos.be/tag/pcre/">pcre</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>A recent update of <em>libpcre</em> caused the binary precompiled regular
expression files of SELinux to become outdated (and even blatantly
wrong). The details are in bug <a href="https://bugs.gentoo.org/471718">471718</a>
but that doesn't help the users that are already facing the problem, nor
have we found a good place to put the fix …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/07/rebuilding-selinux-contexts-with-sefcontext_compile/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-finishing-up/">A SELinux policy for incron: finishing up</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-05-31T03:50:00+02:00"> Fri 31 May 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/incron/">incron</a>
        /
	<a href="https://blog.siphos.be/tag/policy/">policy</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>After 9 posts, it's time to wrap things up. You can review the final
results online
(<a href="http://dev.gentoo.org/~swift/blog/01/incron.te.txt">incron.te</a>,
<a href="http://dev.gentoo.org/~swift/blog/01/incron.if.txt">incron.if</a> and
<a href="http://dev.gentoo.org/~swift/blog/01/incron.fc.txt">incron.fc</a>) and
adapt to your own needs if you want. But we should also review what we
have accomplished so far...</p>
<p>We built the start of an entire …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-finishing-up/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-using-booleans/">A SELinux policy for incron: using booleans</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-05-30T03:50:00+02:00"> Thu 30 May 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/boolean/">boolean</a>
        /
	<a href="https://blog.siphos.be/tag/incron/">incron</a>
        /
	<a href="https://blog.siphos.be/tag/policy/">policy</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>After using a default set of directories to watch, and <a href="http://blog.siphos.be/2013/05/a-selinux-policy-for-incron-marking-types-eligible-for-watching/">allowing admins
to mark other
types</a>
as such as well, let's consider another approach for making the policy
more flexible: booleans. The idea now is that a boolean called
<em>incron_notify_non_security_files</em> enables <strong>incrond</strong> to be
notified on changes on all possible …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-using-booleans/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-marking-types-eligible-for-watching/">A SELinux policy for incron: marking types eligible for watching</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-05-29T03:50:00+02:00"> Wed 29 May 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/attribute/">attribute</a>
        /
	<a href="https://blog.siphos.be/tag/incrond/">incrond</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
        /
	<a href="https://blog.siphos.be/tag/watch/">watch</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>In the
<a herf="http://blog.siphos.be/2013/05/a-selinux-policy-for-incron-default-set/">previous
post</a> we made <strong>incrond</strong> able to watch <code>public_content_t</code> and
<code>public_content_rw_t</code> types. However, this is not scalable, so we might
want to be able to update the policy more dynamically with additional
types. To accomplish this, we will make types eligible for watching
through an attribute.</p>
<p>So how …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-marking-types-eligible-for-watching/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-default-set/">A SELinux policy for incron: default set</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-05-28T03:50:00+02:00"> Tue 28 May 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/booleans/">booleans</a>
        /
	<a href="https://blog.siphos.be/tag/incrond/">incrond</a>
        /
	<a href="https://blog.siphos.be/tag/policy/">policy</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>I finished the last post a bit with a
<a href="http://blog.siphos.be/2013/05/a-selinux-policy-for-incron-the-incrond-daemon/">cliffhanger</a>
as <strong>incrond</strong> is still not working properly, and we got a few denials
that needed to be resolved; here they are again for your convenience:</p>
<div class="highlight"><pre><span></span><code>type=AVC msg=audit(1368734110.912:28353): avc:  denied  { getattr } for  pid=9716 comm=&quot;incrond …</code></pre></div>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-default-set/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-the-incrond-daemon/">A SELinux policy for incron: the incrond daemon</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-05-27T03:50:00+02:00"> Mon 27 May 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/incrond/">incrond</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>With <code>incrontab_t</code> (hopefully) complete, let's look at the <code>incrond_t</code>
domain. As this domain will also be used to execute the user (and
system) commands provided through the incrontabs, we need to consider
how we are going to deal with this wide range of possible permissions
that it might take. One …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-the-incrond-daemon/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-new-types-and-transitions/">A SELinux policy for incron: new types and transitions</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-05-26T03:50:00+02:00"> Sun 26 May 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/incron/">incron</a>
        /
	<a href="https://blog.siphos.be/tag/policy/">policy</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>So I've shown the <a href="http://blog.siphos.be/2013/05/a-selinux-policy-for-incron-basic-set-for-incrontab/">iterative approach
used</a>
to develop policies. Again, please be aware that this is my way of
developing policies, other policy developers might have a different
approach. We were working on the <strong>incrontab</strong> command, so let's
continue with trying to create a new user incrontab:</p>
<div class="highlight"><pre><span></span><code>$ incrontab -e …</code></pre></div>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-new-types-and-transitions/">more ...</a>
                </div>
            </article>
            <hr/>
            <article>
                <h2><a href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-basic-set-for-incrontab/">A SELinux policy for incron: basic set for incrontab</a></h2>
                    <div class="well well-sm">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2013-05-25T03:50:00+02:00"> Sat 25 May 2013</time>
    </span>


            <span class="label label-default">By</span>
            <a href="https://blog.siphos.be/pages/about.html"><i class="fa fa-user"></i> Sven Vermeulen</a>

        <span class="label label-default">Category</span>
        <a href="https://blog.siphos.be/category/selinux.html">SELinux</a>


<span class="label label-default">Tags</span>
	<a href="https://blog.siphos.be/tag/incron/">incron</a>
        /
	<a href="https://blog.siphos.be/tag/incrontab/">incrontab</a>
        /
	<a href="https://blog.siphos.be/tag/policy/">policy</a>
        /
	<a href="https://blog.siphos.be/tag/selinux/">selinux</a>
    
</footer><!-- /.post-info -->                    </div>
                <div class="summary"><p>Now that our <a href="http://blog.siphos.be/2013/05/a-selinux-policy-for-incron-our-first-interface/">regular user is
allowed</a>
to execute <strong>incrontab</strong>, let's fire it up and look at the denials to
build up the policy.</p>
<div class="highlight"><pre><span></span><code>$ incrontab --help
</code></pre></div>

<p>That doesn't show much does it? Well, if you look into the <code>audit.log</code>
(or <code>avc.log</code>) file, you'll notice a lot of denials …</p>
                    <a class="btn btn-default btn-xs" href="https://blog.siphos.be/2013/05/a-selinux-policy-for-incron-basic-set-for-incrontab/">more ...</a>
                </div>
            </article>
            <hr/>

        <ul class="pagination">
                <li class="prev"><a href="https://blog.siphos.be/category/selinux3.html">&laquo;</a>
                </li>
                    <li class=""><a
                            href="https://blog.siphos.be/category/selinux.html">1</a></li>
                    <li class=""><a
                            href="https://blog.siphos.be/category/selinux2.html">2</a></li>
                    <li class=""><a
                            href="https://blog.siphos.be/category/selinux3.html">3</a></li>
                    <li class="active"><a
                            href="https://blog.siphos.be/category/selinux4.html">4</a></li>
                    <li class=""><a
                            href="https://blog.siphos.be/category/selinux5.html">5</a></li>
                    <li class=""><a
                            href="https://blog.siphos.be/category/selinux6.html">6</a></li>
                    <li class=""><a
                            href="https://blog.siphos.be/category/selinux7.html">7</a></li>
                    <li class=""><a
                            href="https://blog.siphos.be/category/selinux8.html">8</a></li>
                <li class="next"><a
                        href="https://blog.siphos.be/category/selinux5.html">&raquo;</a></li>
        </ul>
        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>

<section class="well well-sm">
    <ul class="list-group list-group-flush">
            <li class="list-group-item"><h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Social</span></h4>
              <ul class="list-group" id="social">
                <li class="list-group-item"><a href="https://github.com/sjvermeu"><i class="fa fa-github-square fa-lg"></i> GitHub</a></li>
                <li class="list-group-item"><a href="https://twitter.com/sjvermeu"><i class="fa fa-twitter-square fa-lg"></i> Twitter</a></li>
              </ul>
            </li>





    <li class="list-group-item"><h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
      <ul class="list-group" id="links">
        <li class="list-group-item">
            <a href="http://www.gentoo.org" target="_blank">
                Gentoo Linux
            </a>
        </li>
      </ul>
    </li>
    </ul>
</section>
            </aside>
        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2017 Sven Vermeulen
            &middot; Powered by <a href="https://github.com/DandyDev/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://blog.siphos.be/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://blog.siphos.be/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://blog.siphos.be/theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'simplicityisaformofart'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->

</body>
</html>